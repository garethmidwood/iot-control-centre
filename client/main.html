<head>
  <title>Control Centre</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

  <script type="text/javascript" src="js/fitty.min.js"></script>
  <script type="text/javascript" src="js/nosleep.min.js"></script>

  <meta name="viewport" content="minimal-ui, width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  <script>
    var noSleep = new NoSleep();

    document.addEventListener('click', function enableNoSleep() {
        document.removeEventListener('click', enableNoSleep, false);
        noSleep.enable();
    }, false);
  </script>



  <script>
    function requestFullScreen() {

        var el = document.body;

        // Supports most browsers and their versions.
        var requestMethod = el.requestFullScreen || el.webkitRequestFullScreen 
        || el.mozRequestFullScreen || el.msRequestFullScreen;

        if (requestMethod) {
            // Native full screen.
            requestMethod.call(el);
        } else if (typeof window.ActiveXObject !== "undefined") {
            // Older IE.
            var wscript = new ActiveXObject("WScript.Shell");

            if (wscript !== null) {
                wscript.SendKeys("{F11}");
            }
        }

        return false;
    }
</script>



</head>

<body>
    {{#if isAdmin}}
        {{> admin_view}}
    {{else}}
        <a class="fullscreen" href="#" onclick="requestFullScreen(); $(this).remove();">full screen</a>
        {{> location_tiles}}
    {{/if}}
</body>



<template name="device">
    <li class="online"><strong>{{_id}}</strong></li>
</template>

<template name="beat_counter">
    <div class="beat_counter">
        <span>{{config.value}}</span>bpm
    </div>
</template>

<template name="beat_controls">
    <div class="beat_controls">
        {{#if sequenceIsPaused}}
            <button id="beat-control-play">PLAY</button>
        {{else}}
            <button id="beat-control-pause">PAUSE</button>
        {{/if}}

        <button id="beat-control-reset">RESET</button>

        <button id="beat-control-disconnect">DISCONNECT ALL</button>
    </div>

    <div>
        {{dump_json}}
    </div>
</template>


<template name="location_tiles">
    {{#if positionSelected}}
        <div class="fullscreen {{#if positionIsActive}}active-position{{/if}}">
            {{#if sequenceIsPaused}}
                <h1 class="selected-position">{{positionSelected}}</h1>
                <script>
                    fitty('h1.selected-position');
                </script>
            {{/if}}

            {{#if positionIsActive}}
                <!-- Set the gif duration in server main.js in the startup func -->
                <!-- <div class="fullscreen abstract1"></div> -->
                <!-- <div class="fullscreen abstract2"></div> -->
                <!-- <div class="fullscreen abstract3"></div> -->
                <div class="fullscreen logo1"></div>
                <!-- <div class="fullscreen logo2"></div> -->
            {{/if}}
        </div>
    {{else}}
        <ul id="location-tiles">
            {{#each locations}}
                {{> location}}
            {{/each}}
        </ul>
    {{/if}}
</template>

<template name="location">
    <li><a href="#" class="{{#if sessionId}}taken{{/if}} {{#if positionIsActive (_id)}}current{{/if}}" data-position="{{_id}}">{{_id}}</a></li>
</template>

















<template name="admin_view">
    <div id="admin-view">
        <div id="admin-locations">
            {{> location_tiles}} 
        </div>
        <div id="admin-controls">    
            <h1>ADMIN CONTROLS</h1>

            {{> beat_counter}}
            {{> beat_controls}}
            {{> sequence_controls}}
        </div>
    </div>   
</template>

